<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<app-header></app-header>
<div class="container" id="main-role-manager-container">
    <a (click)="onOpenModal(null, 'add')"
       class="btn btn-secondary float-right mt-n1">New User</a><br>
    <h1 class="h3 mb-3"></h1>
  <div class="row">
    <div *ngFor="let user of users" class="col-md-6">
      <div class="card widget-user">
        <div class="card-body">
          <div class="wid-u-info">
            <h5 class="mt-3 mb-1">{{user.firstName}} {{user.lastName}}</h5>
            <p class="text-muted mb-0">{{user.email}}</p>
            <p class="badge bg-success my-2" *ngIf="user.enabled">ENABLED</p>
            <p class="badge bg-danger my-2" *ngIf="!user.enabled">DISABLED</p>
            <div class="user-position">
              <span class="text-info">{{user.role}}</span>
            </div>
          </div>
        </div>
        <div class="card-header">
          <div class="float-left btn-group btn-group-sm">
            <a (click)="onOpenModal(user, 'edit')"
               class="btn tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Edit"><i class="fa fa-pencil"></i> </a>
            <a (click)="onOpenModal(user, 'delete')"
               class="btn tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-times"></i></a>
            <a *ngIf="!user.enabled" (click)="enableUser(user.userId)"
               class="btn tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-unlock"></i></a>
            <a *ngIf="user.enabled" (click)="disableUser(user.userId)"
               class="btn tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-ban"></i></a>
            <a *ngIf="user.role != 'ADMIN'" (click)="requestAdmin(user.userId)"
               class="btn tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Delete"><i class="fa fa-arrow-up"></i></a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal edit -->
<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editProjectModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editModalLabel">Edit projects</h5>
      </div>
      <div class="modal-body">
        <form #editProjectForm="ngForm">
          <div class="form-group">
            <label for="edit-user-firstName">FirstName</label>
            <input type="text" ngModel="{{editUser?.firstName}}" name="firstName" class="form-control" id="edit-user-firstName" placeholder="Name" required>
          </div>
          <div class="form-group">
            <label for="edit-user-lastName">LastName</label>
            <input type="text" ngModel="{{editUser?.lastName}}" name="lastName" class="form-control" id="edit-user-lastName" placeholder="LastName" required>
          </div>
          <div class="form-group">
            <input type="hidden" ngModel="{{editUser?.userId}}" name="userId" class="form-control" id="edit-user-id" placeholder="userId" required>
          </div>
          <div class="form-group">
            <label for="edit-user-email">E-mail</label>
            <input type="text" ngModel="{{editUser?.email}}" name="email" class="form-control" id="edit-user-email" placeholder="email" required>
          </div>
          <div class="form-group">
            <label for="edit-user-password">Change password</label>
            <input type="password" ngModel="{{editUser?.password}}" name="password" class="form-control" id="edit-user-password" placeholder="password" required>
          </div>
          <div class="modal-footer">
            <button type="button" id="edit-project-form" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button (click)="updateUser(editProjectForm.value)" type="submit" class="btn btn-primary" >Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Add -->
<div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addProjectModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addModalLabel">Add user...</h5>
      </div>
      <div class="modal-body">
        <form #addForm="ngForm" (ngSubmit)="addUser()">
          <div class="form-group">
            <label for="add-user-firstname">FirstName</label>
            <input type="text" [(ngModel)]="user.firstName" name="name" class="form-control" id="add-user-firstname" placeholder="Name" required>
          </div>
          <div class="form-group">
            <label for="add-user-lastName">LastName</label>
            <input type="text" [(ngModel)]="user.lastName" name="lastname" class="form-control" id="add-user-lastName" placeholder="lastname" required>
          </div>
          <div class="form-group">
            <label for="add-user-email">Email</label>
            <input type="email" [(ngModel)]="user.email" name="email" class="form-control" id="add-user-email" placeholder="email" required>
          </div>
          <div class="form-group">
            <label for="add-user-password">Password</label>
            <input type="password" [(ngModel)]="user.password" name="password" class="form-control" id="add-user-password" placeholder="password" required>
          </div>
          <div class="modal-footer">
            <button type="button" id="add-project-form" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button [disabled]="addForm.invalid" type="submit" class="btn btn-primary" >Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="deleteUserModal" tabindex="-1" aria-labelledby="deleteUserModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Delete item?</h5>
      </div>
      <div class="modal-footer">
        <button type="button" id="del-project-form" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button (click)="deleteUser(delUser.userId)" type="submit" class="btn btn-danger" >Delete</button>
      </div>
    </div>
  </div>
</div>
